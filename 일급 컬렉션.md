# 일급 컬렉션 
> 해당 MD는 [jojoldu님의 게시글](https://jojoldu.tistory.com/412) 팔로우하고 있습니다.       
   
일급 컬렉션이란, `Collection`을 `Wrapping`하면서, **그 외 다른 멤버 변수가 없는 상태를 말한다.**    
    
이러한, Wrapping 함으로써 다음과 같은 이점을 가지게 된다.
   
* 비지니스에 종속적인 자료구조
* Collection의 불변성을 보장
* 상태와 행위를 한 곳에서 관리
* 이름이 있는 컬렉션

# 비즈니스에 종속적인 자료구조   
코드에 `List<클래스>` 타입의 컬렉션이 존재한다고 가정한다.   

```java
public void methodOne() {
    List<클래스> list = createListConcrete();
    validate(list);
    // 비즈니스 로직 1
}

public void methodTwo() {
    List<클래스> list = createListConcrete();
    validate(list);    
    // 비즈니스 로직 2
}

public void methodThree() {
    List<클래스> list = createListConcrete();
    validate(list);
    // 비즈니스 로직 3
}
```
각각의 컬렉션 객체들은 비즈니스 로직을 처리하는 데 사용된다.          
그렇기에, **비즈니스 로직을 수행하기전에 알맞은 객체인지 검증 작업을 거쳐야한다.**             
이런 코드가 100개, 1000개, 10000개가 되면 이를 전부 관리할 수 있을까?        
갯수 뿐만 아니라 검증을 위해서는 이전 코드의 로직을 알고 있어야 한다.     
만약 신입 사원이 이 코드를 본다면 이를 관리할 수 있을까? 그건 힘들다고 생각한다.    
       
**컬렉션은 일종의 원시타입과 같은 객체이다.**       
자료를 저장하는데 유용한 기능을 제공해주지만, 프레임워크라는 이름 그대로   
사용자가 프레임워크의 골격에 맞춰서 코딩을 진행해야하는 부분이 있다.      
예를 들면, 6개로 갯수제한을 주고 싶어도 그러지 못한다는 것이다.   
       
그렇다면 **사용자가 원하는대로 관리해줄 수 있는 `클래스/객체`는 어디 없을까?**       
개인적으로 미리 작성된 API를 찾아서 사용하고자 하는 자세는 매우 좋다고 생각한다.        
하지만, 아쉽게도 내가 원하는 기능을 100% 가진 `클래스/객체`는 당연히 존재하지 않는다.    
                   
우리는 이 문제를 아주 쉽게 해결할 수 있다. 우리는 개발자이기 때문이다.          
내가 원하는 기능을 가진 자료구조가 없으면 만들면 되는 것이다.          
    
```java
package step4.domain.racing;

import step4.domain.car.Car;
import step4.domain.car.position.Position;
import step4.domain.ipnut.InputNames;
import step4.startegy.Move;

import java.util.List;
import java.util.Objects;
import java.util.stream.Collectors;

public final class Cars {

    private final List<Car> cars;

    public Cars(String s) {
        this(new InputNames(s));
    }

    public Cars(InputNames inputNames) {
        this(inputNames.inputNames().stream()
                .map(Car::new)
                .collect(Collectors.toList()));
    }

    public Cars(List<Car> cars) {
        if (isNull(cars)) {
            throw new IllegalArgumentException("유효하지 않은 값을 사용했습니다.");
        }
        this.cars = cars;
    }

    private final boolean isNull(List<Car> cars) {
        return cars == null;
    }

    public final void move(Move move) {
        cars.stream().forEach(car -> car.move(move));
    }

    public final List<Car> cars() {
        return cars;
    }

    public final List<Car> winners(Position winnerPosition) {
        return cars.stream()
                .filter(car -> car.isWinner(winnerPosition))
                .collect(Collectors.toList());
    }

    public final Position maxPosition() {
        return cars.stream()
                .map(car -> car.position())
                .reduce(Position::winningPosition).get();
    }
```
위와 같이 특정 조건으로만 생성 할 수 있는 자료구조를 만들면 위에서 언급한 문제들이 모두 해결된다.     
`Collection`을 `Wrapping`하면서, **그 외 다른 멤버 변수가 없는 상태로 정의되어있다.**           
그리고 이런 클래스를 우린 일급 컬렉션이라고 부른다.     
               
여기서 만약, 자동차의 갯수를 6개 이하로 만든다던지, 자동차가 null인지.        
특정 자동차 움직이게 한다던지(인터페이스로 분리하여 가능하게 할 수 있다. - 엘레강트 오브젝트)           
정리하자면 기존의 컬렉션에 우리가 원하는 제약조건을 걸어두는 것은 물론 한 번에 관리할 수 있다.               
  
# 불변  


